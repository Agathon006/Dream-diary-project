{"version":3,"file":"otherBundles/bundle_register.js","mappings":"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","sources":["webpack://dream_diary_project/./js/pages/register/index.js"],"sourcesContent":["'use strict';\r\n\r\n// import Model from './model.js'\r\n// import View from './view.js'\r\n// import Controller from './controller.js'\r\n\r\n// window.addEventListener('DOMContentLoaded', () => {\r\n//     new Controller(new View(), new Model()).init();\r\n// });\r\n\r\nwindow.addEventListener('DOMContentLoaded', () => {\r\n    const form = document.querySelector('#register-form'),\r\n        nicknameInput = document.querySelector('#nickname-input'),\r\n        emailInput = document.querySelector('#email-input'),\r\n        passwordInput = document.querySelector('#password-input'),\r\n        SubmitButton = document.querySelector('#register-form-submit');\r\n\r\n    form.addEventListener('submit', (e) => {\r\n        e.preventDefault();\r\n        document.querySelectorAll('.wrong-input').forEach(item => {\r\n            item.classList.remove('wrong-input');\r\n        })\r\n        document.querySelectorAll('.wrong-span').forEach(item => {\r\n            item.remove();\r\n        })\r\n\r\n        const formData = new FormData(form);\r\n        const formInfo = Object.fromEntries(formData);\r\n        console.log(formInfo);\r\n        let isValidationOkay = true;\r\n        if (!formInfo.nickname.match(/^[a-zA-Z][a-zA-Z0-9_]{4,14}$/)) {\r\n            nicknameInput.classList.add('wrong-input');\r\n            let warningSpan = document.createElement('span');\r\n            warningSpan.innerText = \"Nickname must consist of 5-15 numbers/letters and can't start with a number\";\r\n            warningSpan.classList.add('wrong-span');\r\n            nicknameInput.parentNode.insertBefore(warningSpan, nicknameInput.nextSibling);\r\n            isValidationOkay = false;\r\n        }\r\n        if (!formInfo.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\r\n            emailInput.classList.add('wrong-input');\r\n            let warningSpan = document.createElement('span');\r\n            warningSpan.innerText = \"Incorrect email\";\r\n            warningSpan.classList.add('wrong-span');\r\n            emailInput.parentNode.insertBefore(warningSpan, emailInput.nextSibling);\r\n            isValidationOkay = false;\r\n        }\r\n        if (!formInfo.password.match(/^(?=.*[a-z])(?=.*[A-Z]).{6,200}$/)) {\r\n            passwordInput.classList.add('wrong-input');\r\n            let warningSpan = document.createElement('span');\r\n            warningSpan.innerText = \"Password must have 6-200 symbols with at least 1 uppercase and 1 lowercase letter\";\r\n            warningSpan.classList.add('wrong-span');\r\n            passwordInput.parentNode.insertBefore(warningSpan, passwordInput.nextSibling);\r\n            isValidationOkay = false;\r\n        }\r\n\r\n        if (isValidationOkay) {\r\n            const isNicknameInDb = fetch(`http://localhost:3000/users?nickname=${formInfo.nickname}`)\r\n                .then(response => {\r\n                    if (!response.ok) {\r\n                        let warningSpan = document.createElement('span');\r\n                        warningSpan.innerText = \"Network response was not ok\";\r\n                        warningSpan.classList.add('wrong-span');\r\n                        SubmitButton.parentNode.insertBefore(warningSpan, SubmitButton.nextSibling);\r\n                    }\r\n                    return response.json();\r\n                })\r\n                .then(data => {\r\n                    if (data.length) {\r\n                        nicknameInput.classList.add('wrong-input');\r\n                        let warningSpan = document.createElement('span');\r\n                        warningSpan.innerText = \"That nickname is already used\";\r\n                        warningSpan.classList.add('wrong-span');\r\n                        nicknameInput.parentNode.insertBefore(warningSpan, nicknameInput.nextSibling);\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                })\r\n                .catch(error => {\r\n                    let warningSpan = document.createElement('span');\r\n                    warningSpan.innerText = \"Something go wrong... \";\r\n                    warningSpan.classList.add('wrong-span');\r\n                    SubmitButton.parentNode.insertBefore(warningSpan, SubmitButton.nextSibling);\r\n                });\r\n\r\n            const isEmailInDb = fetch(`http://localhost:3000/users?email=${formInfo.email}`)\r\n                .then(response => {\r\n                    if (!response.ok) {\r\n                        let warningSpan = document.createElement('span');\r\n                        warningSpan.innerText = \"Network response was not ok\";\r\n                        warningSpan.classList.add('wrong-span');\r\n                        SubmitButton.parentNode.insertBefore(warningSpan, SubmitButton.nextSibling);\r\n                    }\r\n                    return response.json();\r\n                })\r\n                .then(data => {\r\n                    if (data.length) {\r\n                        emailInput.classList.add('wrong-input');\r\n                        let warningSpan = document.createElement('span');\r\n                        warningSpan.innerText = \"That email is already used\";\r\n                        warningSpan.classList.add('wrong-span');\r\n                        emailInput.parentNode.insertBefore(warningSpan, emailInput.nextSibling);\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                })\r\n                .catch(error => {\r\n                    let warningSpan = document.createElement('span');\r\n                    warningSpan.innerText = \"Something go wrong... \";\r\n                    warningSpan.classList.add('wrong-span');\r\n                    SubmitButton.parentNode.insertBefore(warningSpan, SubmitButton.nextSibling);\r\n                });\r\n\r\n            Promise.all([isNicknameInDb, isEmailInDb])\r\n                .then(data => {\r\n                    if (!(data[0] || data[1])) {\r\n\r\n                        const data = JSON.stringify(Object.fromEntries(formData));\r\n\r\n                        fetch('http://localhost:3000/users', {\r\n                            method: 'POST',\r\n                            headers: {\r\n                                'Content-Type': 'application/json',\r\n                            },\r\n                            body: data,\r\n                        })\r\n                            .then((response) => {\r\n                                if (!response.ok) {\r\n                                    throw new Error('Network response was not ok');\r\n                                }\r\n                                return response.json();\r\n                            })\r\n                            .then((jsonData) => {\r\n                                console.log('Data posted: ', jsonData);\r\n                            })\r\n                            .catch((error) => {\r\n                                console.error('Error posting data: ', error);\r\n                                let warningSpan = document.createElement('span');\r\n                                warningSpan.innerText = \"Something go wrong... \";\r\n                                warningSpan.classList.add('wrong-span');\r\n                                SubmitButton.parentNode.insertBefore(warningSpan, SubmitButton.nextSibling);\r\n                            });\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error:', error);\r\n                });\r\n        }\r\n    });\r\n});"],"names":["window","addEventListener","form","document","querySelector","nicknameInput","emailInput","passwordInput","SubmitButton","e","preventDefault","querySelectorAll","forEach","item","classList","remove","formData","FormData","formInfo","Object","fromEntries","console","log","isValidationOkay","nickname","match","add","warningSpan","createElement","innerText","parentNode","insertBefore","nextSibling","email","password","isNicknameInDb","fetch","then","response","ok","json","data","length","catch","error","isEmailInDb","Promise","all","JSON","stringify","method","headers","body","Error","jsonData"],"sourceRoot":""}